<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title id="pageTitle">üåç Butun Dunyo Bayroqlari ‚Äî Super Mega Versiya</title>
    <style>
        /* Umumiy stillar */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            background: linear-gradient(135deg, #eef3f7 0%, #dce4eb 100%); /* Yumshoq gradient */
            color: #333;
        }
        header { 
            background: #0057b7; 
            color: white; 
            padding: 25px 20px; /* Kattaroq padding */
            text-align: center; 
            font-size: 32px; 
            font-weight: 900; /* Qalinroq shrift */
            position: relative; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        /* Navigatsiya */
        nav { 
            display: flex; 
            justify-content: center; 
            gap: 15px; 
            background: white; 
            padding: 12px; 
            position: sticky; 
            top: 0; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.2); /* Kuchliroq soya */
            z-index: 1000; 
        }
        nav button { 
            padding: 10px 20px; 
            border: none; 
            background: #0057b7; 
            color: white; 
            border-radius: 20px; /* Yumaloq burchaklar */
            cursor: pointer; 
            font-size: 15px; 
            font-weight: bold;
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s; 
        }
        nav button:hover { 
            background: #00448c; 
            transform: translateY(-2px); 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        nav button.active-btn { 
            background: #e3000f; 
            box-shadow: 0 0 0 3px #fff, 0 0 0 5px #e3000f; /* Aktiv rangda soya */
            transform: translateY(0);
        }

        /* Til tanlash */
        .language-selector { 
            position: absolute; 
            top: 20px; 
            right: 20px; 
            padding: 8px 12px; 
            border-radius: 15px; 
            border: 2px solid white; 
            background: rgba(255, 255, 255, 0.2); 
            color: white; 
            cursor: pointer;
            transition: background 0.3s;
        }
        .language-selector:hover {
            background: rgba(255, 255, 255, 0.4); 
        }
        .language-selector option { color: #000; }

        /* Asboblar (qidiruv/filtr) */
        .tools { display: flex; justify-content: center; gap: 20px; margin: 25px; flex-wrap: wrap; }
        .tools input, .tools select { 
            padding: 12px 18px; 
            font-size: 16px; 
            border-radius: 25px; 
            border: 1px solid #ccc; 
            width: 280px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .tools input:focus, .tools select:focus {
            border-color: #0057b7;
            box-shadow: 0 0 8px rgba(0, 87, 183, 0.3);
            outline: none;
        }

        /* Sektsiyalar */
        .section { padding: 30px; animation: fadeIn 0.8s ease-out; }
        .section h2 { 
            text-align: center; 
            color: #0057b7; 
            font-size: 24px; 
            margin-bottom: 25px; 
            border-bottom: 3px solid #e3000f; 
            display: inline-block; 
            padding-bottom: 5px;
        }

        /* Grid va Kartalar */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); 
            gap: 25px; 
            /* 3D effekt uchun asosiy konteyner */
            perspective: 1500px; 
        }
        
        .card { 
            background: white; 
            border-radius: 15px; 
            padding: 15px; 
            text-align: center; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
            cursor: pointer; 
            height: 100%;
            text-decoration: none; 
            color: inherit; 
            
            /* 3D aylanish uchun o'tish */
            transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
            
            /* 3D transformatsiyalar uchun kerak */
            transform-style: preserve-3d; 
            display: flex; 
            flex-direction: column; 
            justify-content: space-between;
            
            /* Orqa fon elementi - effektni kuchaytirish uchun */
            position: relative;
        }
        
        /* Hover effekti - statik transformatsiya */
        .card:hover { 
            transform: translateZ(20px) scale(1.05); /* Z o'qi bo'ylab oldinga chiqish */
            box-shadow: 0 15px 40px rgba(0,0,0,0.3); 
        }
        
        .flag-img { 
            width: 100%; 
            height: 130px; 
            object-fit: cover; 
            border-radius: 10px; 
            margin-bottom: 15px; 
            border: 3px solid #f0f0f0; /* Bayroqqa oq hoshiya */
            transition: transform 0.5s ease;
        }

        .card:hover .flag-img {
            transform: translateZ(30px); /* Rasmni kartaning ichida ham oldinga chiqarish */
        }
        
        .emoji-flag { font-size: 64px; margin: 15px 0; }
        .name { font-weight: 700; margin-top: 8px; font-size: 18px; color: #0057b7; }
        .card div:not(.name, .emoji-flag) { font-size: 14px; color: #555; margin-top: 5px; }

        /* Modal */
        .modal-bg { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); justify-content: center; align-items: center; z-index: 2000; backdrop-filter: blur(5px); }
        .modal { 
            background: white; 
            padding: 30px; 
            border-radius: 20px; 
            width: 90%; 
            max-width: 450px; 
            text-align: center; 
            animation: slideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            transform-style: preserve-3d;
        }
        .modal img { width: 100%; max-height: 220px; object-fit: cover; border-radius: 15px; margin-bottom: 20px; border: 4px solid #f0f0f0; }
        .modal h2 { margin-top: 0; color: #e3000f; font-size: 28px; }
        .modal p { line-height: 1.6; }
        .close { 
            margin-top: 25px; 
            padding: 12px 30px; 
            background: #0057b7; 
            color: white; 
            border: none; 
            border-radius: 30px; 
            cursor: pointer; 
            font-size: 18px; 
            font-weight: bold;
            transition: background 0.3s, transform 0.1s; 
        }
        .close:hover { background: #00448c; transform: scale(1.05); }

        /* Animatsiyalar */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-100px) rotateX(-10deg); opacity: 0; } to { transform: translateY(0) rotateX(0); opacity: 1; } }
    </style>
</head>
<body>

<header>
    <span id="headerTitle">üåç Butun Dunyo Bayroqlari ‚Äî Super Mega Versiya</span>
    <select class="language-selector" id="languageSelector" onchange="setLanguage(this.value)">
        <option value="uz">üá∫üáø O ªzbek</option>
        <option value="en">üá¨üáß English</option>
        <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
        <option value="cn">üá®üá≥ ‰∏≠Êñá</option>
        <option value="kr">üá∞üá∑ ÌïúÍµ≠Ïñ¥</option>
    </select>
</header>

<nav id="navBar">
    <button id="btnRasm" onclick="showSection('rasm', this)" class="active-btn">üìò Rasmli</button>
    <button id="btnInfo" onclick="showSection('info', this)">üìö Ma ºlumotli</button>
    <button id="btnEmoji" onclick="showSection('emoji', this)">üòä Emoji</button>
</nav>

<div class="tools">
    <input type="text" id="search" placeholder="üîç Davlat qidirish..." />
    <select id="filter">
        <option value="all" data-lang-key="all_continents">üåé Barcha qit'alar</option>
        <option value="Asia" data-lang-key="asia">Osiyo</option>
        <option value="Europe" data-lang-key="europe">Yevropa</option>
        <option value="Africa" data-lang-key="africa">Afrika</option>
        <option value="North America" data-lang-key="north_america">Shimoliy Amerika</option>
        <option value="South America" data-lang-key="south_america">Janubiy Amerika</option>
        <option value="Oceania" data-lang-key="oceania">Okeaniya</option>
    </select>
</div>

<div id="rasm" class="section active"><h2 data-lang-key="title_rasm">Rasmli Bayroqlar</h2><div class="grid" id="rasmGrid"></div></div>
<div id="info" class="section"><h2 data-lang-key="title_info">Ma ºlumotli Bayroqlar</h2><div class="grid" id="infoGrid"></div></div>
<div id="emoji" class="section"><h2 data-lang-key="title_emoji">Emoji Bayroqlar</h2><div class="grid" id="emojiGrid"></div></div>

<div id="modalBg" class="modal-bg">
    <div class="modal" id="modal"></div>
</div>

<script>
// ===========================================
// üåê TARJIMA MA'LUMOTLARI
// ===========================================

// Qit'alar nomlarining tarjimalari
const regionTranslations = {
    'Asia': { uz: 'Osiyo', en: 'Asia', ru: '–ê–∑–∏—è', cn: '‰∫öÊ¥≤', kr: 'ÏïÑÏãúÏïÑ' },
    'Europe': { uz: 'Yevropa', en: 'Europe', ru: '–ï–≤—Ä–æ–ø–∞', cn: 'Ê¨ßÊ¥≤', kr: 'Ïú†ÎüΩ' },
    'Africa': { uz: 'Afrika', en: 'Africa', ru: '–ê—Ñ—Ä–∏–∫–∞', cn: 'ÈùûÊ¥≤', kr: 'ÏïÑÌîÑÎ¶¨Ïπ¥' },
    'North America': { uz: 'Shimoliy Amerika', en: 'North America', ru: '–°–µ–≤–µ—Ä–Ω–∞—è –ê–º–µ—Ä–∏–∫–∞', cn: 'ÂåóÁæéÊ¥≤', kr: 'Î∂ÅÎØ∏' },
    'South America': { uz: 'Janubiy Amerika', en: 'South America', ru: '–Æ–∂–Ω–∞—è –ê–º–µ—Ä–∏–∫–∞', cn: 'ÂçóÁæéÊ¥≤', kr: 'ÎÇ®ÎØ∏' },
    'Oceania': { uz: 'Okeaniya', en: 'Oceania', ru: '–û–∫–µ–∞–Ω–∏—è', cn: 'Â§ßÊ¥ãÊ¥≤', kr: 'Ïò§ÏÑ∏ÏïÑÎãàÏïÑ' }
};

// UI Matnlarining tarjimasi
const translations = {
    uz: {
        pageTitle: "üåç Butun Dunyo Bayroqlari ‚Äî Super Mega Versiya", headerTitle: "üåç Butun Dunyo Bayroqlari ‚Äî Super Mega Versiya",
        btn_rasm: "üìò Rasmli", btn_info: "üìö Ma ºlumotli", btn_emoji: "üòä Emoji",
        search_placeholder: "üîç Davlat qidirish...", all_continents: "üåé Barcha qit'alar",
        title_rasm: "Rasmli Bayroqlar", title_info: "Ma ºlumotli Bayroqlar", title_emoji: "Emoji Bayroqlar",
        modal_capital: "Poytaxt:", modal_continent: "Qit ºa:", modal_population: "Aholi:", modal_area: "Maydon:", modal_close: "Yopish"
    },
    en: {
        pageTitle: "üåç World Flags ‚Äî Super Mega Version", headerTitle: "üåç World Flags ‚Äî Super Mega Version",
        btn_rasm: "üìò Image Flags", btn_info: "üìö Data Flags", btn_emoji: "üòä Emoji Flags",
        search_placeholder: "üîç Search Country...", all_continents: "üåé All Continents",
        title_rasm: "Image Flags", title_info: "Data Flags", title_emoji: "Emoji Flags",
        modal_capital: "Capital:", modal_continent: "Continent:", modal_population: "Population:", modal_area: "Area:", modal_close: "Close"
    },
    ru: {
        pageTitle: "üåç –§–ª–∞–≥–∏ –ú–∏—Ä–∞ ‚Äî –°—É–ø–µ—Ä –ú–µ–≥–∞ –í–µ—Ä—Å–∏—è", headerTitle: "üåç –§–ª–∞–≥–∏ –ú–∏—Ä–∞ ‚Äî –°—É–ø–µ—Ä –ú–µ–≥–∞ –í–µ—Ä—Å–∏—è",
        btn_rasm: "üìò –§–ª–∞–≥–∏ (–ö–∞—Ä—Ç–∏–Ω–∫–∏)", btn_info: "üìö –§–ª–∞–≥–∏ (–î–∞–Ω–Ω—ã–µ)", btn_emoji: "üòä –§–ª–∞–≥–∏ (–≠–º–æ–¥–∑–∏)",
        search_placeholder: "üîç –ü–æ–∏—Å–∫ —Å—Ç—Ä–∞–Ω—ã...", all_continents: "üåé –í—Å–µ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—ã",
        title_rasm: "–§–ª–∞–≥–∏ (–ö–∞—Ä—Ç–∏–Ω–∫–∏)", title_info: "–§–ª–∞–≥–∏ (–î–∞–Ω–Ω—ã–µ)", title_emoji: "–§–ª–∞–≥–∏ (–≠–º–æ–¥–∑–∏)",
        modal_capital: "–°—Ç–æ–ª–∏—Ü–∞:", modal_continent: "–ö–æ–Ω—Ç–∏–Ω–µ–Ω—Ç:", modal_population: "–ù–∞—Å–µ–ª–µ–Ω–∏–µ:", modal_area: "–ü–ª–æ—â–∞–¥—å:", modal_close: "–ó–∞–∫—Ä—ã—Ç—å"
    },
    cn: {
        pageTitle: "üåç ‰∏ñÁïåÂõΩÊóó ‚Äî Ë∂ÖÁ∫ßÂ∑®ÂûãÁâà", headerTitle: "üåç ‰∏ñÁïåÂõΩÊóó ‚Äî Ë∂ÖÁ∫ßÂ∑®ÂûãÁâà",
        btn_rasm: "üìò ÂõæÁâáÂõΩÊóó", btn_info: "üìö ‰ø°ÊÅØÂõΩÊóó", btn_emoji: "üòä Ë°®ÊÉÖÂõΩÊóó",
        search_placeholder: "üîç ÊêúÁ¥¢ÂõΩÂÆ∂...", all_continents: "üåé ÊâÄÊúâÂ§ßÊ¥≤",
        title_rasm: "ÂõæÁâáÂõΩÊóó", title_info: "‰ø°ÊÅØÂõΩÊóó", title_emoji: "Ë°®ÊÉÖÂõΩÊóó",
        modal_capital: "È¶ñÈÉΩ:", modal_continent: "Â§ßÊ¥≤:", modal_population: "‰∫∫Âè£:", modal_area: "Èù¢ÁßØ:", modal_close: "ÂÖ≥Èó≠"
    },
    kr: {
        pageTitle: "üåç Ï†Ñ ÏÑ∏Í≥Ñ Íµ≠Í∏∞ ‚Äî ÏäàÌçº Î©îÍ∞Ä Î≤ÑÏ†Ñ", headerTitle: "üåç Ï†Ñ ÏÑ∏Í≥Ñ Íµ≠Í∏∞ ‚Äî ÏäàÌçº Î©îÍ∞Ä Î≤ÑÏ†Ñ",
        btn_rasm: "üìò Ïù¥ÎØ∏ÏßÄ Íµ≠Í∏∞", btn_info: "üìö Ï†ïÎ≥¥ Íµ≠Í∏∞", btn_emoji: "üòä Ïù¥Î™®ÏßÄ Íµ≠Í∏∞",
        search_placeholder: "üîç Íµ≠Í∞Ä Í≤ÄÏÉâ...", all_continents: "üåé Î™®Îì† ÎåÄÎ•ô",
        title_rasm: "Ïù¥ÎØ∏ÏßÄ Íµ≠Í∏∞", title_info: "Ï†ïÎ≥¥ Íµ≠Í∏∞", title_emoji: "Ïù¥Î™®ÏßÄ Íµ≠Í∏∞",
        modal_capital: "ÏàòÎèÑ:", modal_continent: "ÎåÄÎ•ô:", modal_population: "Ïù∏Íµ¨:", modal_area: "Î©¥Ï†Å:", modal_close: "Îã´Í∏∞"
    }
};

let currentLang = 'uz'; // Standart til

// HTML elementlariga murojaat
const rasmGrid = document.getElementById('rasmGrid');
const infoGrid = document.getElementById('infoGrid');
const emojiGrid = document.getElementById('emojiGrid');
const modalBg = document.getElementById('modalBg');
const modal = document.getElementById('modal');
const search = document.getElementById('search');
const filter = document.getElementById('filter');

// ===========================================
// üìä KENGAYTIRILGAN DAVLAT MA'LUMOTLARI (To'liq ro'yxat)
// ===========================================
const countries = [
    {name_uz:'O ªzbekiston', name_en:'Uzbekistan', name_ru:'–£–∑–±–µ–∫–∏—Å—Ç–∞–Ω', name_cn:'‰πåÂÖπÂà´ÂÖãÊñØÂù¶', name_kr:'Ïö∞Ï¶àÎ≤†ÌÇ§Ïä§ÌÉÑ', code:'uz', flag:'üá∫üáø', region:'Asia', capital:'Toshkent', population:36000000, area:'447,400 km¬≤'},
    {name_uz:'Xitoy', name_en:'China', name_ru:'–ö–∏—Ç–∞–π', name_cn:'‰∏≠ÂõΩ', name_kr:'Ï§ëÍµ≠', code:'cn', flag:'üá®üá≥', region:'Asia', capital:'Beijing', population:1425000000, area:'9,597,000 km¬≤'},
    {name_uz:'Hindiston', name_en:'India', name_ru:'–ò–Ω–¥–∏—è', name_cn:'Âç∞Â∫¶', name_kr:'Ïù∏ÎèÑ', code:'in', flag:'üáÆüá≥', region:'Asia', capital:'New Delhi', population:1428000000, area:'3,287,000 km¬≤'},
    {name_uz:'Yaponiya', name_en:'Japan', name_ru:'–Ø–ø–æ–Ω–∏—è', name_cn:'Êó•Êú¨', name_kr:'ÏùºÎ≥∏', code:'jp', flag:'üáØüáµ', region:'Asia', capital:'Tokyo', population:123000000, area:'377,975 km¬≤'},
    {name_uz:'Koreya Respublikasi', name_en:'South Korea', name_ru:'–Æ–∂–Ω–∞—è –ö–æ—Ä–µ—è', name_cn:'Èü©ÂõΩ', name_kr:'ÎåÄÌïúÎØºÍµ≠', code:'kr', flag:'üá∞üá∑', region:'Asia', capital:'Seoul', population:51700000, area:'100,210 km¬≤'},
    {name_uz:'Qozog ªiston', name_en:'Kazakhstan', name_ru:'–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω', name_cn:'ÂìàËê®ÂÖãÊñØÂù¶', name_kr:'Ïπ¥ÏûêÌùêÏä§ÌÉÑ', code:'kz', flag:'üá∞üáø', region:'Asia', capital:'Astana', population:19000000, area:'2,725,000 km¬≤'},
    {name_uz:'Turkiya', name_en:'Turkey', name_ru:'–¢—É—Ä—Ü–∏—è', name_cn:'ÂúüËÄ≥ÂÖ∂', name_kr:'ÌÑ∞ÌÇ§', code:'tr', flag:'üáπüá∑', region:'Europe', capital:'Ankara', population:86000000, area:'783,562 km¬≤'},
    {name_uz:'Saudiya Arabistoni', name_en:'Saudi Arabia', name_ru:'–°–∞—É–¥–æ–≤—Å–∫–∞—è –ê—Ä–∞–≤–∏—è', name_cn:'Ê≤ôÁâπÈòøÊãâ‰ºØ', name_kr:'ÏÇ¨Ïö∞ÎîîÏïÑÎùºÎπÑÏïÑ', code:'sa', flag:'üá∏üá¶', region:'Asia', capital:'Riyadh', population:37000000, area:'2,150,000 km¬≤'},
    {name_uz:'Rossiya', name_en:'Russia', name_ru:'–†–æ—Å—Å–∏—è', name_cn:'‰øÑÁΩóÊñØ', name_kr:'Îü¨ÏãúÏïÑ', code:'ru', flag:'üá∑üá∫', region:'Europe', capital:'Moscow', population:144000000, area:'17,100,000 km¬≤'},
    {name_uz:'Buyuk Britaniya', name_en:'UK', name_ru:'–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è', name_cn:'Ëã±ÂõΩ', name_kr:'ÏòÅÍµ≠', code:'gb', flag:'üá¨üáß', region:'Europe', capital:'London', population:67000000, area:'242,495 km¬≤'},
    {name_uz:'Fransiya', name_en:'France', name_ru:'–§—Ä–∞–Ω—Ü–∏—è', name_cn:'Ê≥ïÂõΩ', name_kr:'ÌîÑÎûëÏä§', code:'fr', flag:'üá´üá∑', region:'Europe', capital:'Paris', population:64800000, area:'551,695 km¬≤'},
    {name_uz:'Germaniya', name_en:'Germany', name_ru:'–ì–µ—Ä–º–∞–Ω–∏—è', name_cn:'Âæ∑ÂõΩ', name_kr:'ÎèÖÏùº', code:'de', flag:'üá©üá™', region:'Europe', capital:'Berlin', population:84000000, area:'357,588 km¬≤'},
    {name_uz:'Italiya', name_en:'Italy', name_ru:'–ò—Ç–∞–ª–∏—è', name_cn:'ÊÑèÂ§ßÂà©', name_kr:'Ïù¥ÌÉàÎ¶¨ÏïÑ', code:'it', flag:'üáÆüáπ', region:'Europe', capital:'Rome', population:58700000, area:'301,340 km¬≤'},
    {name_uz:'Ukraina', name_en:'Ukraine', name_ru:'–£–∫—Ä–∞–∏–Ω–∞', name_cn:'‰πåÂÖãÂÖ∞', name_kr:'Ïö∞ÌÅ¨ÎùºÏù¥ÎÇò', code:'ua', flag:'üá∫üá¶', region:'Europe', capital:'Kyiv', population:40000000, area:'603,628 km¬≤'},
    {name_uz:'Ispaniya', name_en:'Spain', name_ru:'–ò—Å–ø–∞–Ω–∏—è', name_cn:'Ë•øÁè≠Áâô', name_kr:'Ïä§ÌéòÏù∏', code:'es', flag:'üá™üá∏', region:'Europe', capital:'Madrid', population:47800000, area:'505,992 km¬≤'},
    {name_uz:'AQSH', name_en:'USA', name_ru:'–°–®–ê', name_cn:'ÁæéÂõΩ', name_kr:'ÎØ∏Íµ≠', code:'us', flag:'üá∫üá∏', region:'North America', capital:'Washington D.C.', population:340000000, area:'9,833,517 km¬≤'},
    {name_uz:'Kanada', name_en:'Canada', name_ru:'–ö–∞–Ω–∞–¥–∞', name_cn:'Âä†ÊãøÂ§ß', name_kr:'Ï∫êÎÇòÎã§', code:'ca', flag:'üá®üá¶', region:'North America', capital:'Ottawa', population:40000000, area:'9,984,670 km¬≤'},
    {name_uz:'Meksika', name_en:'Mexico', name_ru:'–ú–µ–∫—Å–∏–∫–∞', name_cn:'Â¢®Ë•øÂì•', name_kr:'Î©ïÏãúÏΩî', code:'mx', flag:'üá≤üáΩ', region:'North America', capital:'Mexico City', population:129000000, area:'1,964,375 km¬≤'},
    {name_uz:'Braziliya', name_en:'Brazil', name_ru:'–ë—Ä–∞–∑–∏–ª–∏—è', name_cn:'Â∑¥Ë•ø', name_kr:'Î∏åÎùºÏßà', code:'br', flag:'üáßüá∑', region:'South America', capital:'Brasilia', population:217000000, area:'8,515,767 km¬≤'},
    {name_uz:'Argentina', name_en:'Argentina', name_ru:'–ê—Ä–≥–µ–Ω—Ç–∏–Ω–∞', name_cn:'ÈòøÊ†πÂª∑', name_kr:'ÏïÑÎ•¥Ìó®Ìã∞ÎÇò', code:'ar', flag:'üá¶üá∑', region:'South America', capital:'Buenos Aires', population:46000000, area:'2,780,400 km¬≤'},
    {name_uz:'Misr', name_en:'Egypt', name_ru:'–ï–≥–∏–ø–µ—Ç', name_cn:'ÂüÉÂèä', name_kr:'Ïù¥ÏßëÌä∏', code:'eg', flag:'üá™üá¨', region:'Africa', capital:'Cairo', population:114000000, area:'1,002,450 km¬≤'},
    {name_uz:'Nigeriya', name_en:'Nigeria', name_ru:'–ù–∏–≥–µ—Ä–∏—è', name_cn:'Â∞ºÊó•Âà©‰∫ö', name_kr:'ÎÇòÏù¥ÏßÄÎ¶¨ÏïÑ', code:'ng', flag:'üá≥üá¨', region:'Africa', capital:'Abuja', population:230000000, area:'923,768 km¬≤'},
    {name_uz:'Janubiy Afrika', name_en:'South Africa', name_ru:'–Æ–∂–Ω–∞—è –ê—Ñ—Ä–∏–∫–∞', name_cn:'ÂçóÈùû', name_kr:'ÎÇ®ÏïÑÌîÑÎ¶¨Ïπ¥', code:'za', flag:'üáøüá¶', region:'Africa', capital:'Pretoria', population:62000000, area:'1,221,037 km¬≤'},
    {name_uz:'Avstraliya', code:'au', flag:'üá¶üá∫', region:'Oceania', capital:'Canberra', name_en:'Australia', name_ru:'–ê–≤—Å—Ç—Ä–∞–ª–∏—è', name_cn:'Êæ≥Â§ßÂà©‰∫ö', name_kr:'Ìò∏Ï£º', population:27000000, area:'7,692,024 km¬≤'},
    {name_uz:'Yangi Zelandiya', code:'nz', flag:'üá≥üáø', region:'Oceania', capital:'Wellington', name_en:'New Zealand', name_ru:'–ù–æ–≤–∞—è –ó–µ–ª–∞–Ω–¥–∏—è', name_cn:'Êñ∞Ë•øÂÖ∞', name_kr:'Îâ¥ÏßàÎûúÎìú', population:5300000, area:'268,021 km¬≤'},
    {name_uz:'Qirg ªiziston', name_en:'Kyrgyzstan', name_ru:'–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω', name_cn:'ÂêâÂ∞îÂêâÊñØÊñØÂù¶', name_kr:'ÌÇ§Î•¥Í∏∞Ïä§Ïä§ÌÉÑ', code:'kg', flag:'üá∞üá¨', region:'Asia', capital:'Bishkek', population:7000000, area:'199,900 km¬≤'},
    {name_uz:'Tojikiston', name_en:'Tajikistan', name_ru:'–¢–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω', name_cn:'Â°îÂêâÂÖãÊñØÂù¶', name_kr:'ÌÉÄÏßÄÌÇ§Ïä§ÌÉÑ', code:'tj', flag:'üáπüáØ', region:'Asia', capital:'Dushanbe', population:10000000, area:'143,100 km¬≤'},
    {name_uz:'Turkmaniston', name_en:'Turkmenistan', name_ru:'–¢—É—Ä–∫–º–µ–Ω–∏—Å—Ç–∞–Ω', name_cn:'ÂúüÂ∫ìÊõºÊñØÂù¶', name_kr:'Ìà¨Î•¥ÌÅ¨Î©îÎãàÏä§ÌÉÑ', code:'tm', flag:'üáπüá≤', region:'Asia', capital:'Ashgabat', population:7000000, area:'488,100 km¬≤'},
    {name_uz:'Afg ªoniston', name_en:'Afghanistan', name_ru:'–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω', name_cn:'ÈòøÂØåÊ±ó', name_kr:'ÏïÑÌîÑÍ∞ÄÎãàÏä§ÌÉÑ', code:'af', flag:'üá¶üá´', region:'Asia', capital:'Kabul', population:41000000, area:'652,860 km¬≤'},
    {name_uz:'Armaniston', name_en:'Armenia', name_ru:'–ê—Ä–º–µ–Ω–∏—è', name_cn:'‰∫öÁæéÂ∞º‰∫ö', name_kr:'ÏïÑÎ•¥Î©îÎãàÏïÑ', code:'am', flag:'üá¶üá≤', region:'Asia', capital:'Yerevan', population:3000000, area:'29,743 km¬≤'},
    {name_uz:'Ozarbayjon', name_en:'Azerbaijan', name_ru:'–ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω', name_cn:'ÈòøÂ°ûÊãúÁñÜ', name_kr:'ÏïÑÏ†úÎ•¥Î∞îÏù¥Ïûî', code:'az', flag:'üá¶üáø', region:'Asia', capital:'Baku', population:10000000, area:'86,600 km¬≤'},
    {name_uz:'Filippin', name_en:'Philippines', name_ru:'–§–∏–ª–∏–ø–ø–∏–Ω—ã', name_cn:'Ëè≤ÂæãÂÆæ', name_kr:'ÌïÑÎ¶¨ÌïÄ', code:'ph', flag:'üáµüá≠', region:'Asia', capital:'Manila', population:118000000, area:'300,000 km¬≤'},
    {name_uz:'Pokiston', name_en:'Pakistan', name_ru:'–ü–∞–∫–∏—Å—Ç–∞–Ω', name_cn:'Â∑¥Âü∫ÊñØÂù¶', name_kr:'ÌååÌÇ§Ïä§ÌÉÑ', code:'pk', flag:'üáµüá∞', region:'Asia', capital:'Islamabad', population:240000000, area:'881,913 km¬≤'},
    {name_uz:'Vyetnam', name_en:'Vietnam', name_ru:'–í—å–µ—Ç–Ω–∞–º', name_cn:'Ë∂äÂçó', name_kr:'Î≤†Ìä∏ÎÇ®', code:'vn', flag:'üáªüá≥', region:'Asia', capital:'Hanoi', population:99000000, area:'331,212 km¬≤'},
    {name_uz:'Indoneziya', name_en:'Indonesia', name_ru:'–ò–Ω–¥–æ–Ω–µ–∑–∏—è', name_cn:'Âç∞Â∫¶Â∞ºË•ø‰∫ö', name_kr:'Ïù∏ÎèÑÎÑ§ÏãúÏïÑ', code:'id', flag:'üáÆüá©', region:'Asia', capital:'Jakarta', population:277000000, area:'1,904,569 km¬≤'},
    {name_uz:'Keniya', name_en:'Kenya', name_ru:'–ö–µ–Ω–∏—è', name_cn:'ËÇØÂ∞º‰∫ö', name_kr:'ÏºÄÎÉê', code:'ke', flag:'üá∞üá™', region:'Africa', capital:'Nairobi', population:56000000, area:'580,367 km¬≤'},
    {name_uz:'Gana', name_en:'Ghana', name_ru:'–ì–∞–Ω–∞', name_cn:'Âä†Á∫≥', name_kr:'Í∞ÄÎÇò', code:'gh', flag:'üá¨üá≠', region:'Africa', capital:'Accra', population:34000000, area:'238,533 km¬≤'},
    {name_uz:'Shvetsiya', name_en:'Sweden', name_ru:'–®–≤–µ—Ü–∏—è', name_cn:'ÁëûÂÖ∏', name_kr:'Ïä§Ïõ®Îç¥', code:'se', flag:'üá∏üá™', region:'Europe', capital:'Stockholm', population:10500000, area:'450,295 km¬≤'},
    {name_uz:'Shveytsariya', name_en:'Switzerland', name_ru:'–®–≤–µ–π—Ü–∞—Ä–∏—è', name_cn:'ÁëûÂ£´', name_kr:'Ïä§ÏúÑÏä§', code:'ch', flag:'üá®üá≠', region:'Europe', capital:'Bern', population:8800000, area:'41,285 km¬≤'},
    {name_uz:'Gvatemala', name_en:'Guatemala', name_ru:'–ì–≤–∞—Ç–µ–º–∞–ª–∞', name_cn:'Âç±Âú∞È©¨Êãâ', name_kr:'Í≥ºÌÖåÎßêÎùº', code:'gt', flag:'üá¨üáπ', region:'North America', capital:'Guatemala City', population:18000000, area:'108,889 km¬≤'},
    {name_uz:'Chili', name_en:'Chile', name_ru:'–ß–∏–ª–∏', name_cn:'Êô∫Âà©', name_kr:'Ïπ†Î†à', code:'cl', flag:'üá®üá±', region:'South America', capital:'Santiago', population:19700000, area:'756,102 km¬≤'},
    {name_uz:'Paragvay', name_en:'Paraguay', name_ru:'–ü–∞—Ä–∞–≥–≤–∞–π', name_cn:'Â∑¥ÊãâÂú≠', name_kr:'ÌååÎùºÍ≥ºÏù¥', code:'py', flag:'üáµüáæ', region:'South America', capital:'Asunci√≥n', population:6800000, area:'406,752 km¬≤'},
    {name_uz:'Singapur', name_en:'Singapore', name_ru:'–°–∏–Ω–≥–∞–ø—É—Ä', name_cn:'Êñ∞Âä†Âù°', name_kr:'Ïã±Í∞ÄÌè¨Î•¥', code:'sg', flag:'üá∏üá¨', region:'Asia', capital:'Singapore', population:6000000, area:'710 km¬≤'},
    {name_uz:'Tailand', name_en:'Thailand', name_ru:'–¢–∞–∏–ª–∞–Ω–¥', name_cn:'Ê≥∞ÂõΩ', name_kr:'ÌÉúÍµ≠', code:'th', flag:'üáπüá≠', region:'Asia', capital:'Bangkok', population:71000000, area:'513,120 km¬≤'},
    {name_uz:'Eron', name_en:'Iran', name_ru:'–ò—Ä–∞–Ω', name_cn:'‰ºäÊúó', name_kr:'Ïù¥ÎûÄ', code:'ir', flag:'üáÆüá∑', region:'Asia', capital:'Tehran', population:89000000, area:'1,648,195 km¬≤'},
    {name_uz:'Iroq', name_en:'Iraq', name_ru:'–ò—Ä–∞–∫', name_cn:'‰ºäÊãâÂÖã', name_kr:'Ïù¥ÎùºÌÅ¨', code:'iq', flag:'üáÆüá∂', region:'Asia', capital:'Baghdad', population:46000000, area:'438,317 km¬≤'},
    {name_uz:'Isroil', name_en:'Israel', name_ru:'–ò–∑—Ä–∞–∏–ª—å', name_cn:'‰ª•Ëâ≤Âàó', name_kr:'Ïù¥Ïä§ÎùºÏóò', code:'il', flag:'üáÆüá±', region:'Asia', capital:'Jerusalem', population:9900000, area:'22,072 km¬≤'},
    {name_uz:'Malayziya', name_en:'Malaysia', name_ru:'–ú–∞–ª–∞–π–∑–∏—è', name_cn:'È©¨Êù•Ë•ø‰∫ö', name_kr:'ÎßêÎ†àÏù¥ÏãúÏïÑ', code:'my', flag:'üá≤üáæ', region:'Asia', capital:'Kuala Lumpur', population:34000000, area:'330,803 km¬≤'},
    {name_uz:'Bangladesh', name_en:'Bangladesh', name_ru:'–ë–∞–Ω–≥–ª–∞–¥–µ—à', name_cn:'Â≠üÂä†ÊãâÂõΩ', name_kr:'Î∞©Í∏ÄÎùºÎç∞Ïãú', code:'bd', flag:'üáßüá©', region:'Asia', capital:'Dhaka', population:174000000, area:'147,570 km¬≤'},
    {name_uz:'Nepal', name_en:'Nepal', name_ru:'–ù–µ–ø–∞–ª', name_cn:'Â∞ºÊ≥äÂ∞î', name_kr:'ÎÑ§Ìåî', code:'np', flag:'üá≥üáµ', region:'Asia', capital:'Kathmandu', population:30000000, area:'147,181 km¬≤'},
    {name_uz:'Gretsiya', name_en:'Greece', name_ru:'–ì—Ä–µ—Ü–∏—è', name_cn:'Â∏åËÖä', name_kr:'Í∑∏Î¶¨Ïä§', code:'gr', flag:'üá¨üá∑', region:'Europe', capital:'Athens', population:10400000, area:'131,957 km¬≤'},
    {name_uz:'Polsha', name_en:'Poland', name_ru:'–ü–æ–ª—å—à–∞', name_cn:'Ê≥¢ÂÖ∞', name_kr:'Ìè¥ÎûÄÎìú', code:'pl', flag:'üáµüá±', region:'Europe', capital:'Warsaw', population:37700000, area:'312,696 km¬≤'},
    {name_uz:'Ruminiya', name_en:'Romania', name_ru:'–†—É–º—ã–Ω–∏—è', name_cn:'ÁΩóÈ©¨Â∞º‰∫ö', name_kr:'Î£®ÎßàÎãàÏïÑ', code:'ro', flag:'üá∑üá¥', region:'Europe', capital:'Bucharest', population:19000000, area:'238,397 km¬≤'},
    {name_uz:'Niderlandiya', name_en:'Netherlands', name_ru:'–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã', name_cn:'Ëç∑ÂÖ∞', name_kr:'ÎÑ§ÎçúÎûÄÎìú', code:'nl', flag:'üá≥üá±', region:'Europe', capital:'Amsterdam', population:17800000, area:'41,850 km¬≤'},
    {name_uz:'Belgiya', name_en:'Belgium', name_ru:'–ë–µ–ª—å–≥–∏—è', name_cn:'ÊØîÂà©Êó∂', name_kr:'Î≤®Í∏∞Ïóê', code:'be', flag:'üáßüá™', region:'Europe', capital:'Brussels', population:11800000, area:'30,689 km¬≤'},
    {name_uz:'Portugaliya', name_en:'Portugal', name_ru:'–ü–æ—Ä—Ç—É–≥–∞–ª–∏—è', name_cn:'Ëë°ËêÑÁâô', name_kr:'Ìè¨Î•¥Ìà¨Í∞à', code:'pt', flag:'üáµüáπ', region:'Europe', capital:'Lisbon', population:10400000, area:'92,212 km¬≤'},
    {name_uz:'Avstriya', name_en:'Austria', name_ru:'–ê–≤—Å—Ç—Ä–∏—è', name_cn:'Â••Âú∞Âà©', name_kr:'Ïò§Ïä§Ìä∏Î¶¨ÏïÑ', code:'at', flag:'üá¶üáπ', region:'Europe', capital:'Vienna', population:9100000, area:'83,879 km¬≤'},
    {name_uz:'Vengriya', name_en:'Hungary', name_ru:'–í–µ–Ω–≥—Ä–∏—è', name_cn:'ÂåàÁâôÂà©', name_kr:'ÌóùÍ∞ÄÎ¶¨', code:'hu', flag:'üá≠üá∫', region:'Europe', capital:'Budapest', population:9600000, area:'93,030 km¬≤'},
    {name_uz:'Marokash', name_en:'Morocco', name_ru:'–ú–∞—Ä–æ–∫–∫–æ', name_cn:'Êë©Ê¥õÂì•', name_kr:'Î™®Î°úÏΩî', code:'ma', flag:'üá≤üá¶', region:'Africa', capital:'Rabat', population:38000000, area:'446,550 km¬≤'},
    {name_uz:'Jazoir', name_en:'Algeria', name_ru:'–ê–ª–∂–∏—Ä', name_cn:'ÈòøÂ∞îÂèäÂà©‰∫ö', name_kr:'ÏïåÏ†úÎ¶¨', code:'dz', flag:'üá©üáø', region:'Africa', capital:'Algiers', population:47000000, area:'2,381,741 km¬≤'},
    {name_uz:'Kongo (DRK)', name_en:'DR Congo', name_ru:'–î–† –ö–æ–Ω–≥–æ', name_cn:'ÂàöÊûúÔºàÈáëÔºâ', name_kr:'ÏΩ©Í≥†ÎØºÏ£ºÍ≥µÌôîÍµ≠', code:'cd', flag:'üá®üá©', region:'Africa', capital:'Kinshasa', population:105000000, area:'2,345,410 km¬≤'},
    {name_uz:'Efiopiya', name_en:'Ethiopia', name_ru:'–≠—Ñ–∏–æ–ø–∏—è', name_cn:'ÂüÉÂ°û‰øÑÊØî‰∫ö', name_kr:'ÏóêÌã∞Ïò§ÌîºÏïÑ', code:'et', flag:'üá™üáπ', region:'Africa', capital:'Addis Ababa', population:128000000, area:'1,104,300 km¬≤'},
    {name_uz:'Tanzaniya', name_en:'Tanzania', name_ru:'–¢–∞–Ω–∑–∞–Ω–∏—è', name_cn:'Âù¶Ê°ëÂ∞º‰∫ö', name_kr:'ÌÉÑÏûêÎãàÏïÑ', code:'tz', flag:'üáπüáø', region:'Africa', capital:'Dodoma', population:68000000, area:'947,303 km¬≤'},
    {name_uz:'Puerto-Riko', name_en:'Puerto Rico', name_ru:'–ü—É—ç—Ä—Ç–æ-–†–∏–∫–æ', name_cn:'Ê≥¢Â§öÈªéÂêÑ', name_kr:'Ìë∏ÏóêÎ•¥ÌÜ†Î¶¨ÏΩî', code:'pr', flag:'üáµüá∑', region:'North America', capital:'San Juan', population:3200000, area:'8,870 km¬≤'},
    {name_uz:'Kuba', name_en:'Cuba', name_ru:'–ö—É–±–∞', name_cn:'Âè§Â∑¥', name_kr:'Ïø†Î∞î', code:'cu', flag:'üá®üá∫', region:'North America', capital:'Havana', population:11000000, area:'109,884 km¬≤'},
    {name_uz:'Kolumbiya', name_en:'Colombia', name_ru:'–ö–æ–ª—É–º–±–∏—è', name_cn:'Âì•‰º¶ÊØî‰∫ö', name_kr:'ÏΩúÎ°¨ÎπÑÏïÑ', code:'co', flag:'üá®üá¥', region:'South America', capital:'Bogot√°', population:52000000, area:'1,141,748 km¬≤'},
    {name_uz:'Peru', name_en:'Peru', name_ru:'–ü–µ—Ä—É', name_cn:'ÁßòÈ≤Å', name_kr:'ÌéòÎ£®', code:'pe', flag:'üáµüá™', region:'South America', capital:'Lima', population:34000000, area:'1,285,216 km¬≤'},
    {name_uz:'Venesuela', name_en:'Venezuela', name_ru:'–í–µ–Ω–µ—Å—É—ç–ª–∞', name_cn:'ÂßîÂÜÖÁëûÊãâ', name_kr:'Î≤†ÎÑ§ÏàòÏóòÎùº', code:'ve', flag:'üáªüá™', region:'South America', capital:'Caracas', population:29000000, area:'916,445 km¬≤'},
    {name_uz:'Fiji', name_en:'Fiji', name_ru:'–§–∏–¥–∂–∏', name_cn:'ÊñêÊµé', name_kr:'ÌîºÏßÄ', code:'fj', flag:'üá´üáØ', region:'Oceania', capital:'Suva', population:900000, area:'18,272 km¬≤'},
    {name_uz:'Samoa', name_en:'Samoa', name_ru:'–°–∞–º–æ–∞', name_cn:'Ëê®Êë©‰∫ö', name_kr:'ÏÇ¨Î™®ÏïÑ', code:'ws', flag:'üáºüá∏', region:'Oceania', capital:'Apia', population:220000, area:'2,842 km¬≤'},
];


// ===========================================
// üõ†Ô∏è FUNKSIYALAR
// ===========================================

/**
 * Aholi sonini o'qilishi oson formatga o'tkazadi
 * @param {number} num 
 */
function formatPopulation(num) {
    if (typeof num === 'number') {
        // Tilga mos lokal format
        const locale = currentLang === 'cn' ? 'zh-CN' : currentLang === 'kr' ? 'ko-KR' : 'en-US'; 
        return num.toLocaleString(locale);
    }
    return num;
}

/**
 * Saytning barcha statik UI elementlarini tarjima qiladi va kontentni yangilaydi.
 */
function translateUI() {
    const lang = translations[currentLang];
    
    // Asosiy sarlavhalar
    document.getElementById('pageTitle').textContent = lang.pageTitle;
    document.getElementById('headerTitle').textContent = lang.headerTitle;
    
    // Navigatsiya tugmalari
    document.getElementById('btnRasm').textContent = lang.btn_rasm;
    document.getElementById('btnInfo').textContent = lang.btn_info;
    document.getElementById('btnEmoji').textContent = lang.btn_emoji;
    
    // Qidiruv joyi
    search.placeholder = lang.search_placeholder;
    
    // Filtrlash menyusi (Qit'alar)
    document.querySelectorAll('#filter option').forEach(option => {
        const key = option.getAttribute('data-lang-key');
        if (option.value !== 'all' && regionTranslations[option.value]) {
            option.textContent = regionTranslations[option.value][currentLang] || option.value;
        } else if (lang[key]) {
             option.textContent = lang[key];
        }
    });

    // Sektsiya sarlavhalari
    document.querySelectorAll('.section h2').forEach(h2 => {
        const key = h2.getAttribute('data-lang-key');
        if (key && lang[key]) {
            h2.textContent = lang[key];
        }
    });

    // Til o'zgarganda ma'lumotlarni qayta yuklash
    filterCountries();
}

/**
 * Tilni almashtiradi va UI ni yangilaydi
 * @param {string} langCode 
 */
function setLanguage(langCode) {
    currentLang = langCode;
    translateUI();
}


/**
 * Berilgan davlatlar ro'yxati asosida Grid'larni to'ldiradi.
 * @param {Array} list 
 */
function fillGrids(list) {
    const nameKey = `name_${currentLang}`;
    const lang = translations[currentLang];

    // Card HTML generatsiyasi
    const generateCardHtml = (c, type) => {
        const regionName = regionTranslations[c.region][currentLang] || c.region; 
        let content = '';

        // Rasm va Ma'lumotli bo'limlarda rasm ishlatiladi
        if (type === 'rasm' || type === 'info') {
             // Bayroq rasmini flagcdn.com saytidan olamiz
            content = `<img class='flag-img' src='https://flagcdn.com/w320/${c.code}.png' alt='${c.name_uz} bayrog ªi'>`;
        } else if (type === 'emoji') {
            content = `<div class='emoji-flag'>${c.flag}</div>`;
        }
        
        let infoHtml = '';
        if (type === 'info') {
            // Ma'lumotli kartochkalar uchun qo'shimcha ma'lumot
            infoHtml = `
                <div>${lang.modal_continent} ${regionName}</div>
                <div>${lang.modal_capital} ${c.capital}</div>
                <div>${lang.modal_population} ${formatPopulation(c.population)}</div>
            `;
        }

        // 'data-name' kartochkalarni aniqlash uchun qo'shildi
        return `
            <a href="#" class='card' data-name='${c.name_uz.replace(/'/g, "\\'")}' onmousemove="handleMouseMove(event, this)" onmouseleave="handleMouseLeave(this)" onclick='event.preventDefault(); openModal("${c.name_uz.replace(/'/g, "\\'")}")'>
                ${content}
                <div class='name'>${c[nameKey] || c.name_uz}</div>
                ${infoHtml}
            </a>`;
    };

    rasmGrid.innerHTML = list.map(c => generateCardHtml(c, 'rasm')).join('');
    infoGrid.innerHTML = list.map(c => generateCardHtml(c, 'info')).join(''); 
    emojiGrid.innerHTML = list.map(c => generateCardHtml(c, 'emoji')).join('');

    // **3D Interaksiya uchun:** Barcha grid kartochkalari sichqoncha harakatini tinglash uchun tayyorlanadi.
    document.querySelectorAll('.grid .card').forEach(card => {
        card.addEventListener('mousemove', (e) => handleMouseMove(e, card));
        card.addEventListener('mouseleave', () => handleMouseLeave(card));
    });
}


// ===========================================
// üñ±Ô∏è 3D INTERAKSIYA FUNKSIYALARI
// ===========================================

/**
 * Sichqoncha harakatiga qarab kartochkani aylantiradi (3D tilt effekti).
 * @param {Event} e 
 * @param {HTMLElement} card 
 */
function handleMouseMove(e, card) {
    const rect = card.getBoundingClientRect();
    const x = e.clientX - rect.left; 
    const y = e.clientY - rect.top; 
    
    const centerX = rect.width / 2;
    const centerY = rect.height / 2;
    
    // -1 dan 1 gacha bo'lgan diapazonga normallashtirish
    const normalizedX = (x - centerX) / centerX;
    const normalizedY = (y - centerY) / centerY;
    
    // Maksimal aylanish burchagi
    const rotateY = normalizedX * 10; 
    const rotateX = normalizedY * -10; // X o'qi atrofida aylanadi (teskari)
    
    const transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.05)`;
    
    card.style.transform = transform;
    
    // Ichki rasmni ham biroz siljitish (chuqurlik effekti uchun)
    const img = card.querySelector('.flag-img');
    if(img) {
        // translateZ(30px) rasmning kartochkadan oldinga chiqishini ta'minlaydi
        img.style.transform = `translateZ(30px) translateX(${-normalizedX * 5}px) translateY(${-normalizedY * 5}px)`;
    }
}

/**
 * Sichqoncha kartochkadan chiqqanda uni asl holatiga qaytaradi.
 * @param {HTMLElement} card 
 */
function handleMouseLeave(card) {
    // Asl holatga qaytarish
    card.style.transform = 'translateZ(0) scale(1)';
    
    // Ichki rasmni asl holatga qaytarish
    const img = card.querySelector('.flag-img');
    if(img) {
        img.style.transform = 'translateZ(0) translateX(0) translateY(0)';
    }
}


// ===========================================
// üîç FILTRLASH VA QIDIRUV
// ===========================================

function filterCountries(){
    const text = search.value.toLowerCase();
    const qit = filter.value;
    
    const filtered = countries.filter(c => {
        const regionMatch = (qit === 'all' || c.region === qit);
        let searchMatch = false;
        if (text === '') {
            searchMatch = true;
        } else {
            // Barcha til variantlarida qidiruv
            for (const key in c) {
                if (key.startsWith('name_') && String(c[key]).toLowerCase().includes(text)) {
                    searchMatch = true;
                    break;
                }
            }
        }
        return regionMatch && searchMatch;
    });
    
    fillGrids(filtered);
}

// Qidiruvni sekinlashtirish (Debounce)
let timeoutId;
function debounce(func, delay) {
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func.apply(this, args);
        }, delay);
    };
}

const debouncedUpdate = debounce(filterCountries, 300);

search.oninput = debouncedUpdate;
filter.onchange = debouncedUpdate;


// ===========================================
// üñºÔ∏è MODAL VA UI BOSHQARUVI
// ===========================================

function openModal(name_uz){
    // O'zbekcha nomi orqali ob'ektni topish
    const c = countries.find(x => x.name_uz === name_uz); 
    if (!c) return;

    const lang = translations[currentLang];
    const nameKey = `name_${currentLang}`;
    const regionName = regionTranslations[c.region][currentLang] || c.region; // Dinamik qit'a nomi

    modal.innerHTML = `
        <h2>${c[nameKey] || c.name_uz}</h2>
        <img src='https://flagcdn.com/w320/${c.code}.png' alt='${c.name_uz} bayrog ªi'>
        <p><b>${lang.modal_capital}</b> ${c.capital}</p>
        <p><b>${lang.modal_continent}</b> ${regionName}</p>
        <p><b>${lang.modal_population}</b> ${formatPopulation(c.population)}</p>
        <p><b>${lang.modal_area}</b> ${c.area}</p>
        <button class='close' onclick='closeModal()'>${lang.modal_close}</button>`;

    modalBg.style.display = "flex";
    document.body.style.overflow = 'hidden';
}

function closeModal(){ 
    modalBg.style.display = "none"; 
    document.body.style.overflow = 'auto';
}

function showSection(id, element){
    // Bo'limlarni ko'rsatish/yashirish
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById(id).classList.add('active');

    // Aktiv tugmani belgilash
    document.querySelectorAll('#navBar button').forEach(btn => btn.classList.remove('active-btn'));
    element.classList.add('active-btn');
}

// Modalni fon bosilganda yopish
modalBg.onclick = function(event) {
    if (event.target === modalBg) {
        closeModal();
    }
}

// Sahifa yuklanganda boshlang'ich tilni o'rnatish
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = localStorage.getItem('appLang') || 'uz'; 
    currentLang = savedLang;
    setLanguage(currentLang);
    document.getElementById('languageSelector').value = currentLang;

    // Tilni almashtirishni saqlash
    document.getElementById('languageSelector').onchange = function() {
        setLanguage(this.value);
        localStorage.setItem('appLang', this.value);
    };
});
</script>

</body>
</html>
